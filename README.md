# YTMusic Migrator

Imports playlist, liked songs from Sporify and collections from Osu and caches this data.

This cached data gets exported to new YTMusic playlists or adds songs to already existing playlists.

_Note: I'm not an developer by profession and the code is far from best practice, this is just something I use personaly that I think might be usefull for someone else, if you see any improvements I'm open for suggestions._

## Note

API connections are not made by myself, I've only modified these for my specific needs.

* YouTube Music Export: <https://github.com/sigma67/ytmusicapi>
  * Exports data to Youtube Music.
* Osu Import: <https://github.com/Piotrekol/CollectionManager>
  * Coverts the hashes out the collection.db file to readable data.
  * Makes it easy to modify collections.
* Spotify Import: <https://github.com/caseychu/spotify-backup>
  * Imports playlists and liked songs from Spotify

## Requirements

* Python 3.10 or greater (Older version not tested).
* Python Modules ytmusicapi.
* Windows 10/ 11.
* Microsoft Notepad (Required for Osu).
* Collection Manager (Required for Osu).

## Set up

* Set up headers_auth.json (Docs: <https://ytmusicapi.readthedocs.io/en/latest/reference.html#library>)
  * Go to <https://music.youtube.com/>
  * Open the network debuging tool of your browser
  * Look for the first item with:
    * Status: "200"
    * Method: "Post"
    * Domain: "music.youtube.com"
    * File: Start with "log_event?alt=json&key="
  * Right click this item click Copy Request Headers
  * Run the script with -setup argument
    * `py YTMusicMigrator.py -setup`
  * Paste the Request Headers in the cli
  * Press enter, then ctrl-z and enter again
  * Note: This token is valid for about 1-2 years or until you sign out from the browser
* Spotify authentication will be set up by the script based on the logged on session in the browser (If not signed in you will need to sign in again or provide an token)
* Osu collections will be imported and the script will guide you trough this process (Read the output!)
* If you want to merge playlist you need to edit the file Merge.txt
  * Open the file Merge.txt
  * The file is formated with \<metaData> and \<\metaData>
    * Everthing in between is handled as data from the YTMusic playlist that will be the destination
    * The options are:
      * Title=ThisIsATitle -> Mainly so you can reqonize wich playlist this is (Not used by script).
      * PlaylistID=PLi9drqWffJ9FWBo7ZVOiaVy0UQQEm4IbP -> The ID of the playlist (Set to Like to like the songs instead of adding to a playlist).
      * Mode=Nightcore -> This will be appended when searching for songs and requires songs to have this in the title or artist name (Exprimental and not required) alternative supported modes:
        * Safe -> Playlist will always be uneffacted by any purge actions.
        * Export -> Export playlists to txt, to be used in combination with the parameter -storeToTxt
  * Everything after \<\metaData> are Spotify or Osu collections playlist names that needs to be exported to this YTMusic playlist (Until the next \<metaData>).
  * See the file itself for an example.

## Settings

These are the available settings in the file Config.json:

* Spotify_Token
  * You can supply your own auth token for spotify.
  * This is not required
* Migrate
  * List with options to specify what to cache and migrate
  * Options:
    * playlists
    * liked
    * osu
* Max_Song_Lenght
  * The maximum lenght an song may have.
  * Setting this to small can resolve in some songs not being enable to be migrated.
  * Setting this to high can resolve in some songs having an "1 hour" version migrated.
* Skip_Playlists
  * Skip the first x playlists.
  * Usefull if something whent wrong halfway and you don't want to redo those playlists.
* Purge_PlaylistsSongs
  * WARNING! USE WITH CAUSION!
  * Will purge songs from any playlist listed in Merge.txt that do not have the safe mode specified.
* Purge_LikedSongs
  * Will remove like from songs in playlist that are listed in Merge.txt that do not have the safe mode specified.
* Delete_Playlists
  * WARNING! USE WITH CAUSION!
  * Delete all playlists listed in createdPlaylistIDs.dmp if there not marked as an safe playlist in Merge.txt.
  * createdPlaylistIDs.dmp is generated by the script when it automaticly creates a new playlists.

These are the script parameters:

* -h/ --help
  * Show an help menu.
* -setup
  * Will run the first time setup for the YTMusicAPI module.
* -storeToTxt
  * Will make an export of known playlists in Merge.txt that are marked for export to Export.dmp.
  * If Export.dmp already excists then it will append the new export.
  * This is done before migration and purging.
* -auto
  * Will run the script without user interaction.
  * This will skip any deletion and purging of songs and playlists.
  * This will skip the Osu import.
  * You will still be asked to sing in to spotify if your not already signed in (The config Spotify_Token will negate this).
* -test
  * Will not create, append like, delete or purge songs and playlists.
  * Will log the output so this is usefull to see what happens when the script where to be ran.

## Order of migration

1. Spotify liked songs (Old to new)
2. Spotify playlists (Old to new)
    * Order of playlists is mainly fixed from the playlist with the most reasond activity to the oldest.
3. Osu Database (As given with the import)
    * If the same name is given as a playlist from spotify then this will be migrated after the same Spotify playlist.
4. Export file (As given with the import)
    * If the same name is given as a playlist from Spotify or Osu then this will be migrated after the same Spotify and/ or Osu playlist.
